# Generated by iptables-save v1.4.10 on Sat Jan 14 01:42:42 2012
*filter
:INPUT ACCEPT [5125:364208]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [2949:375596]
-N InLgD_Gen
-N InLgD_Ch
-N InLgD_Yamdex
-N InLgD_Yoda
-N InLgD_Majestic
-N InLgD_Baidu
-N OutLg
-N SMTP_LOG
-N SPAMMER

-A INPUT -i eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
-A OUTPUT -o eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -i lo -j ACCEPT

-A INPUT -i eth0 -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP
-A INPUT -i eth0 -p tcp -m tcp --tcp-flags FIN,SYN FIN,SYN -j DROP
-A INPUT -i eth0 -p tcp -m tcp --tcp-flags SYN,RST SYN,RST -j DROP
-A INPUT -i eth0 -p tcp -m tcp --tcp-flags FIN,RST FIN,RST -j DROP
-A INPUT -i eth0 -p tcp -m tcp --tcp-flags FIN,ACK FIN -j DROP
-A INPUT -i eth0 -p tcp -m tcp --tcp-flags ACK,URG URG -j DROP

-A INPUT -i eth0 -m state --state INVALID -j ULOG --ulog-nlgroup 1 --ulog-qthreshold 20 --ulog-prefix 'InvalidDrop' 
-A INPUT -i eth0 -m state --state INVALID -j DROP


-A OUTPUT -o eth0 -p tcp --sport 25 -j SMTP_LOG
-A OUTPUT -o eth0 -p tcp --sport 995 -j ACCEPT
-A OUTPUT -o eth0 -p tcp --sport 465 -j ACCEPT
-A OUTPUT -o eth0 -p tcp --dport 53 -j ACCEPT
-A OUTPUT -o eth0 -p udp --dport 53 -j ACCEPT
-A OUTPUT -o eth0 -p tcp --sport 80 -j ACCEPT
-A OUTPUT -o eth0 -p tcp --sport 443 -j ACCEPT
-A OUTPUT -o eth0 -p tcp --sport 10321 -j ACCEPT
-A OUTPUT -o eth0 -p tcp --sport 10322 -j ACCEPT
-A OUTPUT -o eth0 -j OutLg

#spam rules
#Pakistan Triple Play Project SOUTH
-A INPUT -i eth0 -s 182.177.128.0/17 -j SPAMMER

#Bharat Sanchar Nigam Limited
-A INPUT -s 59.92.192.0/20  -j SPAMMER
#Korea Telecom
-A INPUT -s 121.128.0.0/10 -j SPAMMER
#spam TCkermanshah-DSL Iran
-A INPUT -s 2.176.0.0/12 -j SPAMMER
# PT. TELKOM INDONESIA
-A INPUT -s 180.253.144.0/21 -j SPAMMER
#abilene.it 
-A INPUT -s 46.17.152.0/21 -j SPAMMER
#Bharti Airtel Ltd 
-A INPUT -s 182.71.5.0/24 -j SPAMMER
#spam mail apnic.net
-A INPUT -s 119.152.23.0/24 -j SPAMMER 

#kore spam  Korea Telecom
-A INPUT -s 59.0.0.0/11 -j SPAMMER
#spammer HINET Network-Adm
-A INPUT -s 60.249.0.0 -j SPAMMER
-A INPUT -s 93.116.0.0/16 -j SPAMMER
#rus spam alex_cooler@sakha.ru
-A INPUT -s 46.48.128.0/17 -j SPAMMER 
#spam mail descr:          New OGERONET IP Pool beyrut
-A INPUT -s 77.42.160.0/19 -j SPAMMER
#belarus spammer 
-A INPUT -s 93.84.0.0/15 -j SPAMMER
# spam mailer ns1.ikomline.net
-A INPUT -s 95.180.0.0/17 -j SPAMMER
#spam mail Kazakhtelecom Megaline 
-A INPUT -s 95.56.0.0/14 -j SPAMMER
-A INPUT -s 95.59.0.0/16 -j SPAMMER
#BR spammer
-A INPUT -s 186.204/14 -j SPAMMER
# telemar br spam
-A INPUT -s 187.12/14 -j SPAMMER 
# spam Telefonica del Peru
-A INPUT -s 190.232.241/24 -j SPAMMER 
#daily.co.uk spam email
-A INPUT -s 195.234.10.0/23 -j SPAMMER 
#spam taiwan
-A INPUT -s 122.254.0.0/16 -j SPAMMER 
#spam http://bsnl.in/
-A INPUT -s 117.198.0.0/20 -j SPAMMER 
-A INPUT -s 117.200.176.0/20 -j SPAMMER 
-A INPUT -s 117.194.192.0/20 -j SPAMMER 
#spam moscow RADIO-FSU/RADIO-MSU NETWORK
-A INPUT -s 213.252.64.0/18 -j SPAMMER 



#Ch vs East
-A INPUT -i eth0 -s 49.212.0.0/16 -j InLgD_Ch
# CH hack
-A INPUT -i eth0 -s 113.136.0.0/13 -j InLgD_Ch 
#CH
-A INPUT -i eth0 -s 119.176.0.0/12 -j InLgD_Ch
-A INPUT -i eth0 -s 120.40.0.0/14 -j InLgD_Ch
-A INPUT -i eth0 -s 121.8.0.0/13 -j InLgD_Ch 
# CH Telecom
-A INPUT -i eth0 -s 123.112.0.0/12 -j InLgD_Ch
-A INPUT -i eth0 -s 175.45.0.0/18 -j InLgD_Ch
-A INPUT -i eth0 -s 218.186.0.0/16 -j InLgD_Ch

#Gen
-A INPUT -i eth0 -s 41.191.224.0/21 -j InLgD_Gen 
-A INPUT -i eth0 -s 46.4.0.0/16  -j InLgD_Gen 
#sistrix
-A INPUT -i eth0 -s 50.23.239.0/26  -j InLgD_Gen 
#softlayer bot
-A INPUT -i eth0 -s 62.141.43.192/26  -j InLgD_Gen 
-A INPUT -i eth0 -s 62.141.44.0/23 -j InLgD_Gen  
-A INPUT -i eth0 -s 62.141.46.0/24 -j InLgD_Gen 
-A INPUT -i eth0 -s 64.22.64.0/18 -j InLgD_Gen 
-A INPUT -i eth0 -s 69.28.58.0  -j InLgD_Gen 
# huwei symantec
-A INPUT -i eth0 -s 69.58.176.0/20  -j InLgD_Gen 
#verisign ips bot
-A INPUT -i eth0 -s 72.55.179.192/27 -j InLgD_Gen 
-A INPUT -i eth0 -s 77.75.76.0/23 -j InLgD_Gen  
-A INPUT -i eth0 -s 85.95.233/32 -j InLgD_Gen
#seznam
-A INPUT -i eth0 -s 91.143.102.192/26 -j InLgD_Gen 
-A INPUT -i eth0 -s 91.212.12.0/32 -j InLgD_Gen  
#comodo bot
-A INPUT -i eth0 -s 94.23.0.0/18 -j InLgD_Gen 
-A INPUT -i eth0 -s 94.102.0.0/20 -j InLgD_Gen  
#http://www.ovh.com
-A INPUT -i eth0 -s 94.23.0.0/16 -j InLgD_Gen  
#net internet
-A INPUT -i eth0 -s 94.176.166.0/23 -j InLgD_Gen
# roman bot
-A INPUT -i eth0 -s 109.123.125.0/32 -j InLgD_Gen

-A INPUT -i eth0 -s 117.40.0.0/14 -j InLgD_Gen 
-A INPUT -i eth0 -s 119.73.192.32/28 -j InLgD_Gen 

-A INPUT -i eth0 -s 186.28/16 -j InLgD_Gen 
# TavraHost -hack activity
-A INPUT -i eth0 -s 188.95.152.0/21 -j InLgD_Gen 
-A INPUT -i eth0 -s 208.80.192.0/21 -j InLgD_Gen 
-A INPUT -i eth0 -s 205.203.96.0/19 -j InLgD_Gen  
#dow jhons
-A INPUT -i eth0 -s 205.203.128.0/19 -j InLgD_Gen  
#dow johns
-A INPUT -i eth0 -s 206.83.64.0/19 -j InLgD_Gen  
#next gen bot
-A INPUT -i eth0 -s 208.115.111.64/28 -j InLgD_Gen
#ezooms
-A INPUT -i eth0 -s 208.115.113.80/28 -j InLgD_Gen  
#ezooms
-A INPUT -i eth0 -s 213.132.56.32/28 -j InLgD_Gen 
-A INPUT -i eth0 -s 216.139.245.0/24 -j InLgD_Gen 

#Yamdex
-A INPUT -i eth0 -s 87.250.255.0/24 -j InLgD_Yamdex
-A INPUT -i eth0 -s 95.108.128.0/17 -j InLgD_Yamdex
-A INPUT -i eth0 -s 95.108.150.0/24 -j InLgD_Yamdex
-A INPUT -i eth0 -s 95.108.151.0/24 -j InLgD_Yamdex

-A INPUT -i eth0 -s 93.158.128.0/18 -j InLgD_Yamdex
-A INPUT -i eth0 -s 93.158.146.0/23 -j InLgD_Yamdex
#Yoda
-A INPUT -i eth0 -s 61.135.0.0/16 -j InLgD_Yoda

#Majestic
#aster.pl polonyalı ttnet gibi
-A INPUT -i eth0 -s 31.187.0.0/18 -j InLgD_Majestic
-A INPUT -i eth0 -s 76.72.160.0/20 -j InLgD_Majestic
-A INPUT -i eth0 -s 83.149.126.0/32 -j InLgD_Majestic
-A INPUT -i eth0 -s 84.158.150.245 -j InLgD_Majestic
-A INPUT -i eth0 -s 85.23.163.0/24 -j InLgD_Majestic
-A INPUT -i eth0 -s 87.106.48.0/20 -j InLgD_Majestic
-A INPUT -i eth0 -s 88.112.32.0/22 -j InLgD_Majestic
-A INPUT -i eth0 -s 88.190.13.0/32 -j InLgD_Majestic
-A INPUT -i eth0 -s 108.59.0.0/20 -j InLgD_Majestic
-A INPUT -i eth0 -s 173.236.0.0/17 -j InLgD_Majestic
-A INPUT -i eth0 -s 174.124.0.0/15 -j InLgD_Majestic
-A INPUT -i eth0 -s 188.165.192.0/18 -j InLgD_Majestic
-A INPUT -i eth0 -s 208.107.0.0/16 -j InLgD_Majestic
-A INPUT -i eth0 -s 213.138.96.0/19 -j InLgD_Majestic

#Baidu
-A INPUT -i eth0 -s 119.63.192.0/21 -j InLgD_Baidu
-A INPUT -i eth0 -s 123.125.71.0/32 -j InLgD_Baidu
-A INPUT -i eth0 -s 180.76.0.0/16 -j InLgD_Baidu
-A INPUT -i eth0 -s 220.181.0.0/16 -j InLgD_Baidu


-A InLgD_Gen -m limit --limit 2/min --limit-burst 7 -j ULOG --ulog-nlgroup 1 --ulog-qthreshold 20 --ulog-prefix "In Deny Gen"
-A InLgD_Gen -j DROP

-A InLgD_Ch -m limit --limit 2/min --limit-burst 7 -j ULOG --ulog-nlgroup 1 --ulog-qthreshold 20 --ulog-prefix "In Deny China"
-A InLgD_Ch -j DROP

-A InLgD_Yamdex -m limit --limit 2/min --limit-burst 7 -j ULOG --ulog-nlgroup 1 --ulog-qthreshold 20 --ulog-prefix "In Deny Yamdex"
-A InLgD_Yamdex -j DROP

-A InLgD_Yoda -m limit --limit 2/min --limit-burst 7 -j ULOG --ulog-nlgroup 1 --ulog-qthreshold 20 --ulog-prefix "In Deny Yoda"
-A InLgD_Yoda -j DROP

-A InLgD_Majestic -m limit --limit 2/min --limit-burst 7 -j ULOG --ulog-nlgroup 1 --ulog-qthreshold 20 --ulog-prefix "In Deny Majestic"
-A InLgD_Majestic -j DROP

-A InLgD_Baidu -m limit --limit 2/min --limit-burst 7 -j ULOG --ulog-nlgroup 1 --ulog-qthreshold 20 --ulog-prefix "In Deny Baidu"
-A InLgD_Baidu -j DROP

-A OutLg -m limit --limit 2/min  --limit-burst 7 -j ULOG --ulog-nlgroup 1 --ulog-qthreshold 20 --ulog-prefix "Out"
-A OutLg -j ACCEPT

-A SMTP_LOG -m limit --limit 2/min --limit-burst 7 -j ULOG --ulog-nlgroup 1 --ulog-qthreshold 20 --ulog-prefix "SMTP"
-A SMTP_LOG -j ACCEPT

-A SPAMMER -m limit --limit 2/min --limit-burst 7 -j ULOG --ulog-nlgroup 1 --ulog-qthreshold 20 --ulog-prefix "SPAMMER"
-A SPAMMER -j DROP
COMMIT
